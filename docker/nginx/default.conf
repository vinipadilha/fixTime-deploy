server {
    listen 80;
    server_name _; # O underscore '_' geralmente funciona como um curinga para qualquer nome de servidor.

    # A raiz do documento Nginx deve apontar para onde seu index.php está
    # dentro do contêiner. Se seu index.php está em 'PROJETO/index.php' no seu repositório,
    # ele estará em '/app/PROJETO/' dentro do contêiner.
    root /app/PROJETO;

    # Define os arquivos de índice que o Nginx deve procurar ao acessar um diretório.
    index index.php index.html index.htm;

    # Configuração para lidar com todas as requisições.
    location / {
        # Tenta servir o arquivo solicitado diretamente, ou um diretório com índice,
        # ou, se não encontrar, reescreve para o index.php (com parâmetros de query).
        try_files $uri $uri/ /index.php?$query_string;
    }

    # Configuração para processar arquivos PHP.
    location ~ \.php$ {
        # Passa as requisições PHP para o PHP-FPM, que está escutando na porta 9000.
        fastcgi_pass 127.0.0.1:9000;
        # Indica ao PHP-FPM qual arquivo de índice usar se a requisição for para um diretório.
        fastcgi_index index.php; # <<--- ESSA LINHA É FUNDAMENTAL SER index.php
        # Parâmetros necessários para o FastCGI passar o caminho do script.
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        # Inclui parâmetros FastCGI padrão.
        include fastcgi_params;
    }

    # Opcional: Configurações de log para depuração.
    # access_log /dev/stdout combined; # Logs de acesso para o console
    # error_log /dev/stderr warn; # Logs de erro para o console
}